--- 
layout: default
title: PowerShell Script to Clean Up Downloads Folder
---
<p>Here's a simple PowerShell script to delete files and folders older than 1 month from my Downloads folder:</p>
<pre class="brush: powershell">ls ~\Downloads | where {($_.LastWriteTime).AddMonths(1) -lt (get-date)} | remove-item -force -recurse</pre>
<p>The script deletes items older than 1 month as-is, but this can be adjusted by changing the call to <span style="font-family: courier new,courier;">AddMonths</span> appropriately (there are <a href="http://technet.microsoft.com/en-us/library/ff730960.aspx">other methods</a> on the date object such as <span style="font-family: courier new,courier;">AddDays</span>, <span style="font-family: courier new,courier;">AddHours</span>, <span style="font-family: courier new,courier;">AddMinutes</span>, etc).</p>
<p>The script calls <span style="font-family: courier new,courier;">ls</span> (alias for <span style="font-family: courier new,courier;">Get-ChildItem</span>) on my Downloads folder. The output is piped to a <span style="font-family: courier new,courier;">where</span> clause that filters on the <span style="font-family: courier new,courier;">LastWriteTime</span> property of the current object or <span style="font-family: courier new,courier;">$_</span> (pipline variable). One month is added to <span style="font-family: courier new,courier;">LastWriteTime</span>, and if it's less than (<span style="font-family: courier new,courier;">-lt</span>) the current date then it's piped to <span style="font-family: courier new,courier;">remove-item</span> (which has aliases of <span style="font-family: courier new,courier;">rm</span> and <span style="font-family: courier new,courier;">rmdir</span>) where the file/directory is forcefully removed without prompt and contents in directories is recursively deleted.</p>
<p>This can be called manually every now and then or can be scheduled with Windows task scheduler.</p>
<p>Although this can be done using the <span style="font-family: courier new,courier;">forfiles</span> command in the normal Windows command prompt, I had trouble deleting folders using it and PowerShell is more flexible overall.</p>
<p>Surprisingly, this was hard to find after a little Googling around. It seems to be that way with PowerShell samples, and I hope that's just because it's still relatively new.</p>
